<div style="font-size: 13px; line-height: 2.5;">

# 一、流体力学与传热学回顾 (Review of Fluid Dynamics and Heat Transfer)

## <定义> (Definition):
*   `t` [s]: 时间 (time)
*   `x, y` [m]: 坐标 (coordinates)
*   `u, v`, 或 $u_i$ [m/s]: 速度 (velocity). `u, v` 通常指二维笛卡尔坐标系下的x和y方向速度分量，$u_i$ 是速度分量的张量（或指标）表示法。
*   `T` [K]: 温度 (temperature)
*   $\nu$ [m²/s]: 运动粘度 (kinematic viscosity)
*   $\rho C_p$ [J/m³K]: 体积比热容 (volumetric heat capacity). 其中 $\rho$ 是密度 (density)，$C_p$ 是定压比热容 (specific heat at constant pressure).
*   $\lambda$ [J/mKs]: 热导率 (thermal conductivity)



## (1) 一维热传导方程 (One-dimensional heat conduction equation):
*   $\rho C_p \frac{\partial T}{\partial t} = \lambda \frac{\partial^2 T}{\partial x^2}$
    *   这是非稳态（瞬态）一维热传导方程。
    *   $\rho C_p \frac{\partial T}{\partial t}$: 单位体积内能随时间的变化率。
    *   $\lambda \frac{\partial^2 T}{\partial x^2}$: 沿x方向通过热传导的能量变化率（基于傅里叶定律 (Fourier's Law)）。
*   $\Rightarrow \rho C_p \frac{\partial T}{\partial t} = \lambda \nabla^2 T$
    *   这是上述方程的更通用形式，其中 $\nabla^2 T$ 是温度T的拉普拉斯算子 (Laplacian operator)。在一维情况下，$\nabla^2 T = \frac{\partial^2 T}{\partial x^2}$。
*   **给定稳态条件 (Given a steady-state condition) (e.g., $\frac{\partial T}{\partial t} = 0$)，方程简化为 (the equation is simplified as):**
    *   $\frac{d^2 T}{dx^2} = 0$ (假设 $\lambda \neq 0$)
    *   这表明在稳态一维热传导中，温度沿x方向线性变化。



## (2) 二维热传导方程 (Two-dimensional heat conduction equation):
*   $\rho C_p \frac{\partial T}{\partial t} = \lambda \left( \frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2} \right)$
    *   这是非稳态（瞬态）二维热传导方程。
    *   括号中的 $\left( \frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2} \right)$ 是二维笛卡尔坐标系下拉普拉斯算子 (Laplacian operator) $\nabla^2 T$ 的展开形式。
*   **给定稳态条件 (Given a steady-state condition)，方程简化为 (the equation is simplified as):**
    *   $\frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2} = 0$
    *   这是二维稳态热传导方程，也称为拉普拉斯方程 (Laplace equation)。



## (3) 二维流体流动的连续性方程和纳维-斯托克斯方程 (Continuity and Navier-Stokes equations for two-dimensional fluid flow):

*   **<连续性方程> (Continuity equation):**
    *   $\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} = 0$
    *   这是不可压缩流体 (incompressible fluid) 在二维笛卡尔坐标系下的连续性方程，表示质量守恒 (mass conservation)（体积守恒 (volume conservation)）。
    *   旁边的手写体：
        *   $\nabla \cdot \mathbf{u} = 0$: 这是连续性方程的矢量形式，$\mathbf{u}$ 是速度矢量 (velocity vector)。
        *   $\partial_i u_i = 0$ (或 $\frac{\partial u_i}{\partial x_i} = 0$): 这是连续性方程的张量（爱因斯坦求和）形式 (tensor (Einstein summation) form)。

*   **<u方程> (Equation for u) (即x方向动量方程 (x-direction momentum equation)):**
    *   $\frac{\partial u}{\partial t} + u \frac{\partial u}{\partial x} + v \frac{\partial u}{\partial y} = - \frac{1}{\rho} \frac{\partial P}{\partial x} + \nu \left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} \right)$
    *   这是不可压缩流体纳维-斯托克斯方程的x方向分量。
        *   $\frac{\partial u}{\partial t}$: u的局部加速度 (local acceleration)（非稳态项 (unsteady term)）。
        *   $u \frac{\partial u}{\partial x} + v \frac{\partial u}{\partial y}$: u的对流加速度项 (convective acceleration term)。
        *   $-\frac{1}{\rho} \frac{\partial P}{\partial x}$: x方向的压力梯度力项 (pressure gradient force term)。
        *   $\nu \left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} \right)$: x方向的粘性力项 (viscous force term)。

*   **<v方程> (Equation for v) (即y方向动量方程 (y-direction momentum equation)):**
    *   $\frac{\partial v}{\partial t} + u \frac{\partial v}{\partial x} + v \frac{\partial v}{\partial y} = - \frac{1}{\rho} \frac{\partial P}{\partial y} + \nu \left( \frac{\partial^2 v}{\partial x^2} + \frac{\partial^2 v}{\partial y^2} \right)$
    *   这是不可压缩流体纳维-斯托克斯方程的y方向分量，各项含义与u方程类似。
    *   旁边的手写体（纳维-斯托克斯方程的张量形式 (tensor form of Navier-Stokes equations)）：
        *   $\frac{\partial u_i}{\partial t} + u_j \frac{\partial u_i}{\partial x_j} = - \frac{1}{\rho} \frac{\partial P}{\partial x_i} + \nu \frac{\partial^2 u_i}{\partial x_j \partial x_j}$
            *   $\frac{\partial u_i}{\partial t}$: 局部加速度 (local acceleration)。
            *   $u_j \frac{\partial u_i}{\partial x_j}$: 对流加速度 (convective acceleration)。
            *   $-\frac{1}{\rho} \frac{\partial P}{\partial x_i}$: 压力梯度力 (pressure gradient force)。
            *   $\nu \frac{\partial^2 u_i}{\partial x_j \partial x_j}$ (或 $\nu \nabla^2 u_i$): 粘性力 (viscous force)。



## (4) 使用张量表示的通用形式 (General forms using tensor expression for):

*   **<连续性方程> (Continuity equation):**
    *   $\frac{\partial u_i}{\partial x_i} = 0$
    *   这是不可压缩流体连续性方程的张量形式（使用了爱因斯坦求和约定 (Einstein summation convention)，`i` 从1到3或1到2）。

*   **<NS 方程> (NS equations, 即纳维-斯托克斯方程 (Navier-Stokes equations)):**
    *   $\frac{\partial u_i}{\partial t} + u_j \frac{\partial u_i}{\partial x_j} = - \frac{1}{\rho} \frac{\partial P}{\partial x_i} + \nu \frac{\partial^2 u_i}{\partial x_j^2}$
    *   这是不可压缩流体纳维-斯托克斯方程的张量形式。$\frac{\partial^2 u_i}{\partial x_j^2}$ 表示 $\frac{\partial^2 u_i}{\partial x_j \partial x_j}$，即对所有`j`求和。

*   **<内能方程> (Internal energy equation):**
    *   $\rho \frac{\partial e}{\partial t} + \rho u_j \frac{\partial e}{\partial x_j} = \lambda \frac{\partial^2 T}{\partial x_j^2} + (-P\theta + \Phi)$
        *   这是一个能量守恒方程 (energy conservation equation)，通常用于描述流体温度场的变化。
        *   `e`: 单位质量的内能 (internal energy per unit mass)。
        *   $\rho \frac{\partial e}{\partial t}$: 单位体积内能的时间变化率。
        *   $\rho u_j \frac{\partial e}{\partial x_j}$: 内能的对流输运项 (convective transport of internal energy)。
        *   $\lambda \frac{\partial^2 T}{\partial x_j^2}$: 热传导项 (heat conduction term). (原笔记中为 `a`，已根据上下文修正为 $\lambda$)
        *   $-P\theta$: 压力做功项 (pressure work term)（可逆的体积变化功）。$\theta = \frac{\partial u_j}{\partial x_j}$ 是速度的散度 (divergence of velocity)。对于不可压缩流体，$\theta = 0$，此项消失。
        *   $\Phi$: 粘性耗散函数 (viscous dissipation function)（不可逆的机械能向内能的转化），总是正值。


## 一维热传导方程 (1D HCE) 的数值模拟 (Numerical simulation of one-dimensional heat conduction equation (1D HCE))



## <视频片段> (Video clip):
*   网址链接 (URL): `https://www2.nhk.or.jp/school/watch/bangumi/?das_id=D0005110353_00000`
    *   这可能是一个教学视频，用来演示相关的一维热传导现象。



## <系统示意图> (Schematics of the system):
该图描绘了一个一维热传导的物理模型：
*   **上图：** 一根长度为 $L$ 的金属棒。
    *   左端 ($x=0$) 温度为 $T_L$ [K]。
    *   右端 ($x=L$) 温度为 $T_H$ [K]，旁边有一个火焰的标志，表示右端被加热，且 $T_H > T_L$（高温端温度高于低温端）。
*   **下图：** 温度 $T$ 随位置 $x$ 变化的示意图。
    *   $x$ 轴表示金属棒的位置，从 $0$ 到 $L$。
    *   $T$ 轴表示温度。
    *   在 $x=0$ 处，温度为 $T_L$，标记为 B.C. (Boundary Condition - 边界条件)。
    *   在 $x=L$ 处，温度为 $T_H$，标记为 B.C.。
    *   **红色虚线 (S.S.)**：表示稳态 (Steady State) 温度分布。对于没有内部热源/热损失的纯传导，稳态时温度呈线性分布。
    *   **红色实线曲线**：表示某个瞬态（非稳态）时刻的温度分布，它会随着时间逐渐趋向于稳态的线性分布。



## <目的> (Purposes):
列出了本次学习或实验的目标：
*   理解有限体积法 (FVM) 的本质 (To understand the essence of the finite volume method (FVM))
*   对一维热传导方程的控制方程进行离散化 (To discretize the governing equation of 1D HCE)
*   对温度分布进行数值模拟 (To numerically simulate the temperature distribution)
*   讨论哪些边界条件可以表达视频片段中的温度分布 (To discuss which boundary conditions can express the temperature distribution in the video clip)



## <控制方程> (Governing equation):

*   **自然属性 (Natural properties):**
    *   $\rho C_p$ [J/m³K]: **体积比热容 (volumetric heat capacity)**。
    *   $\lambda$ [J/mKs]: **热导率 (Heat conductivity)**。

*   **定义 (Definitions):**
    *   $t$ [s]: 时间 (time)
    *   $x$: 坐标 [m] (coordinate)
    *   $T(t,x)$: 温度 [K] (temperature)
    *   $q$: **热损失 (heat loss) [J/m³s]**。这是一个单位体积、单位时间内的热量变化率。
    *   $L$: 金属棒的长度 [m] (length of a metal bar)
    *   $T_L$: $x=0$ 处的温度 [K] (temperature at $x = 0$)
    *   $T_H$: $x=L$ 处的温度 [K] (temperature at $x = L$)，并假设 $T_H > T_L$。

*   **方程 (Equation):**
    *   $\rho C_p \frac{\partial T}{\partial t} = \lambda \frac{\partial^2 T}{\partial x^2} - q$
        *   这是包含内部热源/热损失项 $q$ 的一维非稳态热传导方程。
        *   $\rho C_p \frac{\partial T}{\partial t}$: 单位体积内能随时间的变化率。
        *   $\lambda \frac{\partial^2 T}{\partial x^2}$: 沿x方向通过热传导的能量变化率。
        *   $-q$: 表示热损失项。



### 稳态条件下的方程 (Equation under the steady-state condition):
*   当系统达到稳态时，温度不随时间变化，即 $\frac{\partial T}{\partial t} = 0$。
*   此时，方程简化为：$0 = \lambda \frac{d^2 T}{dx^2} - q$
*   整理后得到：$\frac{d^2 T}{dx^2} = \frac{q}{\lambda}$
    *   注意，偏导数 $\partial$ 变成了常导数 $d$，因为在稳态下，温度 $T$ 仅是位置 $x$ 的函数。
    *   如果 $q = 0$（无内部热源或热损失），则 $\frac{d^2 T}{dx^2} = 0$，积分两次得到 $T(x) = C_1 x + C_2$，即线性温度分布。



### <边界条件> (Boundary conditions):
*   $T(0) = T_L$ (在 $x=0$ 处，温度为 $T_L$)
*   $T(L) = T_H$ (在 $x=L$ 处，温度为 $T_H$)
*   这两种都是**第一类边界条件 (Dirichlet boundary conditions)**。




## <模拟条件> (Simulation cases):

### 情况1: 绝热条件 (Case 1: Adiabatic condition) (断熱)
*   **假设 (Assuming):** 金属棒的周围由绝缘材料 (Insulating materials) 完美包裹。
*   **傅里叶热传导定律 (Fourier's Law of Heat Conduction):**
    *   $D = -\lambda \frac{\partial T}{\partial x}$ [W/m²] (传导热流密度 (conductive heat flux density))
*   **说明:** 没有热量从棒的表面损失，因此热损失项 $q$ [J/m³s] 为零。
*   **稳态方程 (Steady-state equation):**
    *   $\frac{d^2 T}{dx^2} = 0$ (因为 $q=0$)



### 情况2: 对流热损失 (假设1) (Case 2: Convective heat loss (assumption 1))
*   **说明:** 在金属棒置于空气中的实际情况下，由于**对流 (Convection)**，热量会从表面损失。
*   **牛顿冷却定律 (Newton's Law of Cooling):**
    *   $C = h(T_s - T_a)$ [W/m²] (对流热流密度 (convective heat flux density))
    *   $h$: **对流换热系数 (heat transfer coefficient)** [W/m²K]
    *   $T_s$: 固体表面温度 (Surface temperature)
    *   $T_a$: 周围流体（空气）的温度 (Ambient air temperature)
*   **假设模型:** 对流热损失不依赖于位置 $x$，而是由金属棒表面与空气之间的**最大温差**引起。热损失项 $q$ [J/m³s] 使用一个系数 $A$ [W/m³K] 建模如下：
    *   $q = A (T_H - T_a)$ [J/m³s]
*   **为了得到一个简单的精确解，假设：**
    *   $A = \frac{2\lambda}{L^2}$
    *   (注意: 此处 $A$ 的单位是 W/m³K。原笔记中 $A [1/m^2s]$ 的单位不正确。物理意义上 $A$ 将温差转换为单位体积热损失率。)



### 情况3: 对流热损失 (假设2) (Case 3: Convective heat loss (assumption 2))
*   **说明:** 与情况2条件相同，但对流热损失模型更精确，使用表面与环境之间的**实际温差** $T(x)$ 和环境温度 $T_a = T_L$ (假设环境温度等于棒的冷端温度 $T_L$)，使用一个系数 $A$ [W/m³K]。
    *   $q = A (T(x) - T_a)$ [J/m³s] (其中 $T_a = T_L$)
*   **为了得到一个简单的精确解，假设 (A is defined as):**
    *   $A = \frac{2h}{R'}$ (这里的 $A$ 应该具有单位 W/m³K)
    *   其中 $h$ 是热传递系数 (heat transfer coefficient) [W/m²K]， $R'$ 是棒的**半径 (radius)** [m] (若 $R'$ 为直径，则 $A = \frac{4h}{R'}$).




## <理论解> (Theoretical solutions):

### 情况1: 绝热条件 (Case 1: Adiabatic condition)
*   **求解控制方程 (Solve the governing equation (GE) of):** $\frac{d^2T}{dx^2} = 0$
*   **在边界条件 (under the boundary conditions (BCs) of) 下:**
    *   $T(0) = T_L$
    *   $T(L) = T_H$

*   **<推导过程> (Derivation):**
    1.  **微分方程 (Differential equation):** $\frac{d^2T}{dx^2} = 0$
    2.  **通解 (General solution):**
        $\frac{dT}{dx} = C_1$
        $T(x) = C_1 x + C_2$
    3.  **应用边界条件 (Applying B.C.):**
        $T(0) = T_L \Rightarrow C_1(0) + C_2 = T_L \Rightarrow C_2 = T_L$
        $T(L) = T_H \Rightarrow C_1(L) + C_2 = T_H \Rightarrow C_1 L + T_L = T_H \Rightarrow C_1 = \frac{T_H - T_L}{L}$
    4.  **特解 (Specific solution):**
        $T(x) = \left(\frac{T_H - T_L}{L}\right) x + T_L$

*   **<精确解> (The exact solution):**
    $T(x) = \frac{x}{L} (T_H - T_L) + T_L$
    *   温度沿棒长呈线性分布。



### 情况2: 对流热损失 (假设1) (Case 2: Convective heat loss (assumption 1))
*   **求解控制方程 (Solve the G.E. of):** $\frac{d^2T}{dx^2} = A_{const}$
    *   其中 $A_{const} = \frac{2}{L^2}(T_H - T_L)$ (这是 $q/\lambda$，这里的 $A_{const}$ 是一个特定假设值，使得解简化)
*   **在边界条件 (with the BCs of) 下:**
    *   $T(0) = T_L$
    *   $T(L) = T_H$

*   **<推导过程> (Derivation):**
    1.  **微分方程 (Differential equation):** $\frac{d^2T}{dx^2} = A_{const}$
    2.  **通解 (General solution):**
        $\frac{dT}{dx} = A_{const}x + C_1$
        $T(x) = \frac{1}{2}A_{const}x^2 + C_1 x + C_2$
    3.  **应用边界条件 (Applying B.C.):**
        $T(0) = T_L \Rightarrow \frac{1}{2}A_{const}(0)^2 + C_1(0) + C_2 = T_L \Rightarrow C_2 = T_L$
        $T(L) = T_H \Rightarrow \frac{1}{2}A_{const}L^2 + C_1 L + C_2 = T_H$
        $\frac{1}{2}A_{const}L^2 + C_1 L + T_L = T_H$
        $C_1 L = T_H - T_L - \frac{1}{2}A_{const}L^2$
        将 $A_{const} = \frac{2}{L^2}(T_H - T_L)$ 代入:
        $C_1 L = T_H - T_L - \frac{1}{2}\left(\frac{2}{L^2}(T_H - T_L)\right)L^2 = T_H - T_L - (T_H - T_L) = 0$
        $\Rightarrow C_1 = 0$
    4.  **特解 (Specific solution):**
        $T(x) = \frac{1}{2}A_{const}x^2 + T_L$
        $T(x) = \frac{1}{2}\left(\frac{2}{L^2}(T_H - T_L)\right)x^2 + T_L$
        $T(x) = \frac{x^2}{L^2}(T_H - T_L) + T_L$

*   **<精确解> (The exact solution):**
    $T(x) = \left(\frac{x}{L}\right)^2 (T_H - T_L) + T_L$
    *   温度沿棒长呈抛物线分布。



### 情况3: 对流热损失 (假设2) (Case 3: Convective heat loss (assumption 2))
*   **求解控制方程 (Solve the G.E. of):** $\frac{d^2T}{dx^2} = A(T - T_L)$
    *   其中 $A = \frac{2h}{\lambda R'}$ (这里的 $A$ 的单位是 $1/m^2$。原 $q = A_q(T-T_L)$ 中的 $A_q$ 单位为 $W/m^3K$，则此处的 $A = A_q/\lambda$)
*   **在边界条件 (with the BCs of) 下:**
    *   $T(0) = T_L$
    *   $T(L) = T_H$
*   **变量代换 (Variable substitution):** 令 $\tau = T - T_L$。则 $\frac{d^2\tau}{dx^2} = \frac{d^2T}{dx^2}$。
    方程变为: $\frac{d^2\tau}{dx^2} = A\tau \Rightarrow \frac{d^2\tau}{dx^2} - A\tau = 0$
*   **变换后的边界条件 (Transformed B.C.):**
    *   $\tau(0) = T(0) - T_L = T_L - T_L = 0$
    *   $\tau(L) = T(L) - T_L = T_H - T_L = \Delta T$

*   **<推导过程> (Derivation):**
    1.  **特征方程 (Characteristic equation):** $m^2 - A = 0 \Rightarrow m = \pm\sqrt{A}$
    2.  **$\tau(x)$ 的通解 (General solution for $\tau(x)$):**
        $\tau(x) = C_1 e^{\sqrt{A}x} + C_2 e^{-\sqrt{A}x}$
        或者使用双曲函数: $\tau(x) = K_1 \cosh(\sqrt{A}x) + K_2 \sinh(\sqrt{A}x)$
    3.  **应用变换后的边界条件 (Applying transformed B.C.):**
        $\tau(0) = 0 \Rightarrow C_1 + C_2 = 0 \Rightarrow C_2 = -C_1$.
        (Using sinh/cosh: $K_1 \cosh(0) + K_2 \sinh(0) = 0 \Rightarrow K_1 = 0$. So $\tau(x) = K_2 \sinh(\sqrt{A}x)$)
        $\tau(L) = \Delta T \Rightarrow K_2 \sinh(\sqrt{A}L) = \Delta T \Rightarrow K_2 = \frac{\Delta T}{\sinh(\sqrt{A}L)}$
    4.  **$\tau(x)$ 的特解 (Specific solution for $\tau(x)$):**
        $\tau(x) = \frac{\Delta T}{\sinh(\sqrt{A}L)} \sinh(\sqrt{A}x) = (T_H - T_L) \frac{\sinh(\sqrt{A}x)}{\sinh(\sqrt{A}L)}$
    5.  **$T(x)$ 的特解 (Specific solution for $T(x)$):**
        $T(x) = \tau(x) + T_L = (T_H - T_L) \frac{\sinh(\sqrt{A}x)}{\sinh(\sqrt{A}L)} + T_L$

*   **<精确解> (The exact solution):**
    $T(x) = (T_H - T_L) \frac{\sinh(\sqrt{A}x)}{\sinh(\sqrt{A}L)} + T_L$
    *   其中 (where) $A = \frac{2h}{\lambda R'}$. (原笔记中为 $\alpha$, 且定义为 $\alpha = A/\lambda = 2h/\lambda R$, 这里的 $A$ 与微分方程中的 $A$ 一致。)
    *   $\sinh(z) \equiv \frac{e^z - e^{-z}}{2}$




## <离散化> (Discretization):

推导离散化方程的过程是 (The processes for deriving the discretized equation are):
1.  **(1) 定义网格和节点 (Define grids and nodes)** (格子, 节点)
2.  **(2) 离散化控制方程 (Discretize governing equations)**
3.  **(3) 引入迭代法 (Introduce an iterative method)** (反復法)
4.  **(4) 绘制流程图 (Draw a flowchart)**



### (1) 使用示意图定义控制体积、网格和节点 (Define the control volume, grids, and nodes using schematics.)

*   **系统:** 长度为 $L$ 的金属棒，左端温度 $T_L$, 右端温度 $T_H$。
*   **离散化:** 金属棒沿长度方向划分为一系列**节点 (nodes)**: $0, 1, 2, \dots, i-1, i, i+1, \dots, N, N+1$.
    *   $T_i$: 节点 $i$ 处的温度。
    *   普通节点 (o nodes): 内部节点 (internal nodes)。
    *   固定节点 (● fixed nodes): 边界节点 (boundary nodes) ($0$ 和 $N+1$).
    *   **控制体积 (Control Volume, C.V.)** (検査体積): 围绕每个内部节点 $i$ 定义。
        *   $\Delta x_i$: 节点 $i$ 处的控制体积宽度。

*   **<变量定义> (Definition of variables):**
    *   $i$: **节点编号 (Node number)**
        *   ($i=0$: $x=0$ 处的节点, $i=N+1$: $x=L$ 处的节点)
    *   $T_i$: **在节点 $i$ 处的温度 (Temperature at node $i$)**
        *   ($T_0 = T_L, T_{N+1} = T_H$; 即边界条件 (B.C.))
    *   $\Delta x_i$: **在节点 $i$ 处的控制体积宽度 (Width of C.V. at node $i$)**
        *   ($\Delta x_0 = \Delta x_{N+1} = 0$ 在某些定义中)
    *   $N$: **内部节点数量 (Number of internal nodes)** (总节点数为 $N+2$)

*   当使用均匀网格分辨率时 (When a uniform grid resolution is used), $\Delta x = L/(N+1)$ (如果 $N$ 是内部节点数，则有 $N+1$ 个间距)。或者，如果 $N$ 是控制体积数量，$\Delta x = L/N$.
    *   (注: 笔记中 `Δx = L/N`. 若 $N$ 是内部节点数，共 $N+2$ 个点，则有 $N+1$ 个等长段。若 $N$ 是CV数量, 每个CV宽度为 $\Delta x = L/N$, 节点 $0$ 和 $N+1$ 为边界。)
*   `i=0` 和 `i=N+1` 被定义是为了程序的一致性。



### (2) 推导离散化方程 (Derive the discretized equations).

*   **控制方程的通用形式 (The G.E, in general form, is written as):**
    $\frac{d^2T}{dx^2} = \frac{q}{\lambda}$ (稳态)

#### 有限差分法 (Finite Difference Method, FDM):
*   导数项使用**泰勒级数展开 (Taylor series expansion)** 进行离散化。
*   $T(x \pm \Delta x) = T(x) \pm \frac{dT}{dx}\Delta x + \frac{1}{2}\frac{d^2T}{dx^2}(\Delta x)^2 \pm \dots$
*   二阶导数的中心差分近似 (Central difference approximation for the second derivative):
    $\frac{d^2T}{dx^2} \approx \frac{T(x+\Delta x) - 2T(x) + T(x-\Delta x)}{(\Delta x)^2}$
    $\Rightarrow \frac{T_{i+1} - 2T_i + T_{i-1}}{(\Delta x)^2}$

#### 有限体积法 (Finite Volume Method, FVM):
*   方程首先在**控制体积 (control volume)** 上进行**积分 (integration)**，然后对积分后的方程中的**表面通量项 (surface flux terms)** 进行近似。
*   **高斯积分定理 (Gauss's integral theorem):** 对于一个矢量场 $\mathbf{u}$ 和一个控制体积 CV:
    $\int_{CV} (\nabla \cdot \mathbf{u}) dV = \oint_S \mathbf{u} \cdot d\mathbf{S}$
    *   $dV$: 体积元 (volume element).
    *   $d\mathbf{S}$: 面元矢量 (surface element vector) ($\mathbf{n} dS$).
    *   $S$: 控制体积的表面 (surface covering the CV).
    *   **含义:** 控制体积内 $\nabla \cdot \mathbf{u}$ 的总和 = 通过表面 $S$ 上 $\mathbf{u}$ 的净通量。



#### 应用FVM到一维热传导方程 (Applying FVM to 1D HCE) (Page 10 of original notes):
*   对控制方程在节点 $i$ 的控制体积 (CV) 上积分:
    $\int_{CV} \frac{d^2T}{dx^2} dx = \int_{CV} \frac{q}{\lambda} dx$
*   **LHS (Left Hand Side):**
    $\int_{CV} \frac{d}{dx}\left(\frac{dT}{dx}\right) dx = \left[\frac{dT}{dx}\right]_w^e = \left(\frac{dT}{dx}\right)_e - \left(\frac{dT}{dx}\right)_w$
    *   下标 $e$ 和 $w$ 分别代表控制体积的东、西界面。
*   **界面梯度的近似 (Approximation of interface gradients):**
    *   $\left(\frac{dT}{dx}\right)_e \approx \frac{T_{i+1} - T_i}{\delta x_e}$ (其中 $\delta x_e = x_{i+1} - x_i$ 是节点 $i$ 和 $i+1$ 之间的距离)
    *   $\left(\frac{dT}{dx}\right)_w \approx \frac{T_i - T_{i-1}}{\delta x_w}$ (其中 $\delta x_w = x_i - x_{i-1}$ 是节点 $i-1$ 和 $i$ 之间的距离)
    *   (原笔记符号: $\left(\frac{dT}{dx}\right)_e = \frac{T_{i+1} - T_i}{0.5(\Delta x_{i+1} + \Delta x_i)}$, $\left(\frac{dT}{dx}\right)_w = \frac{T_i - T_{i-1}}{0.5(\Delta x_i + \Delta x_{i-1})}$. 这里的 $0.5(\Delta x_k + \Delta x_j)$ 指的是节点 $k,j$ 间的距离。)
*   **RHS (Right Hand Side):**
    $\int_{CV} \frac{q}{\lambda} dx \approx \left(\frac{q_i}{\lambda}\right) \Delta X_i$ (其中 $q_i$ 是节点 $i$ 处的源项，$ \Delta X_i$ 是节点 $i$ 的控制体积宽度)
*   **离散方程 (Discretized equation):**
    $\frac{T_{i+1} - T_i}{\delta x_e} - \frac{T_i - T_{i-1}}{\delta x_w} = \left(\frac{q_i}{\lambda}\right) \Delta X_i$
    对于均匀网格 (uniform grid), $\delta x_e = \delta x_w = \Delta X_i = \Delta x$:
    $\frac{T_{i+1} - 2T_i + T_{i-1}}{(\Delta x)^2} = \frac{q_i}{\lambda}$ (与FDM形式相同)
*   **整理为系数形式 (Arranging in coefficient form):**
    $C_e (T_{i+1} - T_i) - C_w (T_i - T_{i-1}) = S_u \Delta X_i$ (这里的 $S_u = q_i/\lambda$)
    $C_e T_{i+1} + C_w T_{i-1} - (C_e + C_w) T_i = S_u \Delta X_i$
    其中 $C_e = \frac{1}{\delta x_e}$, $C_w = \frac{1}{\delta x_w}$.
    令 $C_o = C_e + C_w$.
    $T_i = \frac{1}{C_o} \left( C_e T_{i+1} + C_w T_{i-1} - S_u \Delta X_i \right)$
    $T_i = \frac{C_e T_{i+1} + C_w T_{i-1} - (q_i/\lambda) \Delta X_i}{C_e + C_w}$
    *   (原笔记系数 $C_e = 1/(0.5(\Delta x_i + \Delta x_{i+1}))$, $C_w = 1/(0.5(\Delta x_i + \Delta x_{i-1}))$. 这里 $0.5(...)$ 为节点间距。)



### (3) 应用迭代法 (Apply the iterative method). (Page 11 of original notes)
*   对于 $i=1, \dots, N$:
    $T_1 = \frac{1}{C_o} (C_e T_2 + C_w T_0 - (q_1/\lambda)\Delta X_1)$ ( $T_0$ 是 B.C.)
    $T_2 = \frac{1}{C_o} (C_e T_3 + C_w T_1 - (q_2/\lambda)\Delta X_2)$
    ...
    $T_N = \frac{1}{C_o} (C_e T_{N+1} + C_w T_{N-1} - (q_N/\lambda)\Delta X_N)$ ( $T_{N+1}$ 是 B.C.)
*   这是一个包含 $N$ 个未知数 $T_1, \dots, T_N$ 的 $N$ 个线性代数方程组。
*   由于方程是隐式形式 (implicit form) (陰的), 需要迭代求解。
*   **迭代法步骤 (Iterative method steps) (例如, 求解 $g(x)=0$):**
    1.  将 $g(x)=0$ 重新排列为 $x = f(x)$ 的形式。
    2.  假设一个初始值 $x^{(0)}$，并使用 $x^{(k+1)} = f(x^{(k)})$ 计算下一步的值。
    3.  如果 $x^{(k+1)} \approx x^{(k)}$ (收敛)，则该值是解。否则，用 $x^{(k+1)}$ 替换 $x^{(k)}$ 并重复。
*   **雅可比法 (Jacobi Method):**
    使用上一迭代步 $(k)$ 的值来计算当前迭代步 $(k+1)$ 的所有 $T_i$:
    $T_i^{(k+1)} = \frac{1}{C_o} \left( C_e T_{i+1}^{(k)} + C_w T_{i-1}^{(k)} - (q_i/\lambda) \Delta X_i \right)$
*   重复计算所有 $T_i$ (从 $i=1$ 到 $N$) 直到 $T_i^{(k+1)}$ 和 $T_i^{(k)}$ 之间的差异足够小 (满足收敛准则)。



### (4) 绘制流程图 (Draw the flow chart). (Page 12 of original notes)

1.  **START (开始)**
2.  **定义变量和系数 (Define variables and coefficients):**
    *   温度数组 $T[0 \dots N+1]$
    *   系数 $C_o, C_e, C_w$ (对于每个内部节点或全局，取决于网格)
3.  **设置初始条件和边界条件 (Set Initial Guess & Boundary Conditions):**
    *   对所有内部节点 $i=1 \dots N$, 设置初始猜测值 (Initial Guess), 例如 $T_i^{(0)} = T_L$.
    *   设置边界条件: $T_0 = T_L$, $T_{N+1} = T_H$.
    *   将初始猜测值存为上一迭代值 $T_i^{P} = T_i^{(0)}$.
4.  **迭代计算循环 (Iteration Loop):**
    *   `k = 0, 1, 2, ...` (迭代计数器)
    *   **对所有内部节点 `i = 1` 到 `N` 进行计算 (Loop for `i = 1` to `N`):**
        $T_i^{(k+1)} = \frac{1}{C_o} \left( C_e T_{i+1}^{(k)} + C_w T_{i-1}^{(k)} - (q_i/\lambda) \Delta X_i \right)$
        (注意: $T_{0}^{(k)}$ 和 $T_{N+1}^{(k)}$ 始终是固定的边界值 $T_L$ 和 $T_H$)
5.  **收敛检查 (Convergence Check):**
    *   计算最大绝对差值 (或相对差值) $max\_diff = \max_{i=1\dots N} |T_i^{(k+1)} - T_i^{(k)}|$.
    *   **If $max\_diff < \epsilon$ (预设的收敛容差 (tolerance))?**
        *   **Yes (是):** 迭代收敛, **END (结束)**.
        *   **No (否):**
            *   更新旧值: $T_i^{(k)} \leftarrow T_i^{(k+1)}$ for all $i=1 \dots N$. (或者 $T_i^P \leftarrow T_i^{(k+1)}$)
            *   $k \leftarrow k+1$.
            *   返回到步骤 4 (迭代计算循环)。


# 二、有限体积法 (Finite Volume Method, FVM) 推导热传导方程离散格式筆記

## 第一部分：一维稳态热传导 (1D Steady-State Heat Conduction)

### 1. 问题背景 (Problem Background)

*   **控制方程 (Governing Equation):**
    一维稳态热传导方程 (1D Steady-State Heat Conduction Equation) 如下：
    $$
    \frac{d^2T}{dx^2} = \frac{q(x)}{\lambda}
    $$
    其中：
    *   $T$: 温度 (Temperature) [K]
    *   $x$: 空间坐标 (Spatial Coordinate) [m]
    *   $q(x)$: 单位体积热汇项 (Volumetric Heat Sink Term) [J/m³s 或 W/m³]。若 $q(x) > 0$，代表热汇 (heat sink)；若 $q(x) < 0$，代表热源 (heat source)。
    *   $\lambda$: 材料的热导率 (Thermal Conductivity) [J/mKs 或 W/mK]。

*   **目标 (Objective):**
    推导出用于计算节点 $i$ 处温度 $T_i$ 的离散方程 (Discretized Equation)。

### 2. 有限体积法步骤 (FVM Steps)

*   **步骤1: 控制体积积分 (Control Volume Integration)**
    *   选取节点 $i$ 周围的一个控制体积 (Control Volume, CV)，西边界 $w$ 位于节点 $i-1$ 和 $i$ 的中点，东边界 $e$ 位于节点 $i$ 和 $i+1$ 的中点。控制体积宽度为 $\Delta x_i$。
    *   将控制方程在控制体积 $CV$ 上积分：
        $$
        \int_{CV} \frac{d^2T}{dx^2} dx = \int_{CV} \frac{q}{\lambda} dx
        $$
    *   左边积分得到 (表示通过东边界流出的热通量减去通过西边界流入的热通量，乘以单位面积，此处简化为单位面积上的通量差)：
        $$
        \left(\frac{dT}{dx}\right)\Big|_e - \left(\frac{dT}{dx}\right)\Big|_w
        $$
    *   右边积分 (假设 $q$ 和 $\lambda$ 在控制体积内为常数或平均值)：
        $$
        \frac{q}{\lambda} \Delta x_i
        $$
    *   积分后的平衡方程 (Balance Equation)：
        $$
        \left(\frac{dT}{dx}\right)\Big|_e - \left(\frac{dT}{dx}\right)\Big|_w = \frac{q}{\lambda} \Delta x_i
        $$

*   **步骤2: 界面通量近似 (Approximation of Interface Fluxes)**
    *   使用中心差分 (Central Difference) 近似控制体积界面上的温度梯度：
        *   东边界 $e$ 处的梯度 (Gradient at east face)：
            $$
            \left(\frac{dT}{dx}\right)\Big|_e \approx \frac{T_{i+1} - T_i}{0.5(\Delta x_{i+1} + \Delta x_i)}
            $$
            (节点 $i$ 和 $i+1$ 之间的距离为 $0.5\Delta x_i + 0.5\Delta x_{i+1}$)
        *   西边界 $w$ 处的梯度 (Gradient at west face)：
            $$
            \left(\frac{dT}{dx}\right)\Big|_w \approx \frac{T_i - T_{i-1}}{0.5(\Delta x_i + \Delta x_{i-1})}
            $$
            (节点 $i-1$ 和 $i$ 之间的距离为 $0.5\Delta x_{i-1} + 0.5\Delta x_i$)

*   **步骤3: 代入并整理 (Substitution and Rearrangement)**
    *   将近似的梯度代入积分平衡方程：
        $$
        \left[ \frac{T_{i+1} - T_i}{0.5(\Delta x_{i+1} + \Delta x_i)} \right] - \left[ \frac{T_i - T_{i-1}}{0.5(\Delta x_i + \Delta x_{i-1})} \right] = \frac{q}{\lambda} \Delta x_i
        $$
    *   整理后 (将第二项的分子分母同乘-1，并改变符号)：
        $$
        \frac{T_{i+1} - T_i}{0.5(\Delta x_{i+1} + \Delta x_i)} + \frac{T_{i-1} - T_i}{0.5(\Delta x_i + \Delta x_{i-1})} = \frac{q}{\lambda} \Delta x_i
        $$

*   **步骤4: 引入系数 (Introducing Coefficients)**
    *   定义系数 $C_e$ 和 $C_w$：
        *   $C_e = \frac{1}{0.5(\Delta x_{i+1} + \Delta x_i)}$ (东向系数)
        *   $C_w = \frac{1}{0.5(\Delta x_i + \Delta x_{i-1})}$ (西向系数)
        *   *注意：图片底部 "Here," 部分对 $C_e$ 的定义 `Cₑ = 1 / (0.5(Δxᵢ₊₁ + Δxᵢ₊₁)) = 1/Δxᵢ₊₁` 可能是在均匀网格 $\Delta x_i = \Delta x_{i+1}$ 条件下的简化，或特定假设下的形式。推导过程中使用的 $C_e = \frac{1}{0.5(\Delta x_{i+1} + \Delta x_i)}$ 更具一般性，适用于非均匀网格。*
    *   方程变为：
        $$
        C_e(T_{i+1} - T_i) + C_w(T_{i-1} - T_i) = \frac{q}{\lambda} \Delta x_i
        $$

*   **步骤5: 求解 $T_i$ (Solving for $T_i$)**
    *   展开上式：
        $C_eT_{i+1} - C_eT_i + C_wT_{i-1} - C_wT_i = \frac{q}{\lambda} \Delta x_i$
    *   整理关于 $T_i$ 的项：
        $(C_e + C_w)T_i = C_eT_{i+1} + C_wT_{i-1} - \frac{q}{\lambda} \Delta x_i$
    *   定义 $C_0 = C_e + C_w$ (中心节点系数)
    *   最终得到 $T_i$ 的表达式：
        $$
        T_i = \frac{1}{C_0} \left[ C_eT_{i+1} + C_wT_{i-1} - \frac{q}{\lambda} \Delta x_i \right]
        $$

### 总结 (Summary)
通过有限体积法的积分和离散化步骤，从偏微分形式的稳态热传导方程得到了中心节点 $i$ 的温度 $T_i$ 与其相邻节点及热源/汇项相关的代数方程。这种方法的核心是保证每个控制体积内的热量守恒 (Heat Conservation)。

---

## 第二部分：附录与二维热传导方程介绍 (Appendix and Introduction to 2D Heat Conduction)

### <Appendix> (附录)

*   **三种情况的理论解 (The theoretical solutions for three cases):**
    *   **Case 1 (情况1): 两端固定温度，无内热源 (Fixed temperatures at ends, no internal heat source)**
        (形式上更像是两端固定温度，而不是绝热边界)
        $$
        T(x) = \frac{x}{L} (T_H - T_L) + T_L
        $$
        描述两端温度分别为 $T_L$ (x=0) 和 $T_H$ (x=L)，无内热源 ($q(x)=0$) 的线性温度分布。

    *   **Case 2 (情况2): 有均匀热源/汇 (Uniform heat source/sink)**
        $$
        T(x) = \frac{q}{2\lambda} x^2 + \left(\frac{T_H - T_L}{L} - \frac{qL}{2\lambda}\right) x + T_L
        $$
        描述两端温度固定，但杆内存在均匀体积热源/汇 $q$ 的抛物线型温度分布。
        *   特殊条件：当 $q = \frac{2\lambda}{L^2} (T_H - T_L)$ 时，方程简化为 $T(x) = \frac{T_H - T_L}{L^2} x^2 + T_L$。

    *   **Case 3 (情况3): 热源/汇与局部温度相关 (Source/sink dependent on local temperature)**
        $$
        T(x) = (T_H - T_L) \frac{\sinh(\sqrt{A}x)}{\sinh(\sqrt{A}L)} + T_L, \quad \text{其中 } A = \frac{2h}{\lambda R}
        $$
        (常见于肋片 (fin) 温度分布，或侧面对流换热)

*   **针对 Case 3 的离散方程修正 (Discretized equation re-modeled for Case 3):**
    *   **说明:** 当源项 $q(x)$ 是温度 $T(x)$ 的函数时 (例如 $q(x)$ 包含 $T(x)$)，直接使用前述离散格式可能导致数值解不收敛 (non-convergence)。需将此依赖关系显式包含在离散方程中。
    *   **源项的表达 (Source term expression):**
        假设 Case 3 的源项可表示为 $q(x) = \lambda A (T(x) - T_L)$ （此处的 $q(x)$ 代表额外热量生成，若为热损失，则符号相反，或在代入时调整）。
        那么原控制方程中 $(q/\lambda)$ 项变为 $A(T(x) - T_L)$。
        积分源项：
        $$
        \int_{CV} \frac{q(x)}{\lambda} dx \approx A(T_i - T_L) \Delta x_i
        $$
        (假设 $T(x) \approx T_i$ 在 $CV$ 内)
    *   **修正后的离散方程 (Modified discretized equation):**
        原始离散方程为：$C_e(T_{i+1} - T_i) + C_w(T_{i-1} - T_i) = \frac{q_{ext}}{\lambda} \Delta x_i$。
        如果源项是 $q_{src}(x) = f(T(x))$, 例如 $q_{src}(x)/\lambda = -A(T_i - T_L)$ (表示与温度相关的热损失项，正比于 $T_i - T_L$)。
        则平衡方程为：
        $C_e(T_{i+1} - T_i) + C_w(T_{i-1} - T_i) = -A(T_i - T_L)\Delta x_i$
        整理 $T_i$ 项：
        $C_e T_{i+1} - C_e T_i + C_w T_{i-1} - C_w T_i = -A T_i \Delta x_i + A T_L \Delta x_i$
        $(C_e + C_w + A\Delta x_i)T_i = C_e T_{i+1} + C_w T_{i-1} + A T_L \Delta x_i$
        令 $C_0 = C_e + C_w$:
        $$
        (C_0 + A\Delta x_i)T_i = C_e T_{i+1} + C_w T_{i-1} + A\Delta x_i T_L
        $$
    *   **最终 $T_i$ 的迭代表达式 (Iterative expression for $T_i$):**
        $$
        T_i = \frac{1}{C_0 + A\Delta x_i} \left[ C_e T_{i+1} + C_w T_{i-1} + A\Delta x_i T_L \right]
        $$
    *   **迭代法 (Iterative method) 注解:**
        适用于 $f(x) = 0 \Rightarrow x = g(x) \Rightarrow x_{k+1} = g(x_k)$ 形式的迭代求解。

### 2. 二维热传导方程的数值模拟 (Numerical simulation of two-dimensional heat conduction equation (2D HCE))

*   **<Schematics> (示意图):**
    二维方形区域 (边长 $L$)，坐标轴 $x, y$。温度分布 $T(x,y)$，热源 $q(x,y)$。

*   **<Purpose> (目的):**
    *   将有限体积法 (FVM) 扩展到二维场。
    *   离散化二维热传导方程 (Discretize 2D HCE)。
    *   对二维场的温度分布进行数值模拟。
    *   考虑从一维到二维、三维的扩展。

*   **<Governing equation> (控制方程):**
    *   **Definitions (定义):**
        *   $t$: 时间 (time) [s]
        *   $x, y$: 坐标 (coordinate) [m]
        *   $T(t,x,y)$: 温度 (temperature) [K]
        *   $q(x,y)$: 热损失 (heat loss) [J/m³s] (注意：若定义为热损失，在方程中通常带负号或方程本身形式不同)
        *   $L$: 方形板边长 (length of a square plate) [m]
        *   $T_L$: 低温 (low temperature) [K]
        *   $T_H$: 高温 (high temperature) [K]
        *   $\rho C_p$: 体积比热容 (volumetric specific heat) [J/m³K]

    *   **Governing equation (GE) (控制方程 - 瞬态):**
        $$
        \rho C_p \frac{\partial T}{\partial t} = \lambda\left(\frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2}\right) - q
        $$
        (若 $q$ 为热损失，则方程右边是导热项减去热损失项)
        变形：
        $$
        \frac{\partial T}{\partial t} = \alpha\left(\frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2}\right) - \frac{q}{\rho C_p}
        $$
        其中 $\alpha = \lambda/(\rho C_p)$ 称为 **热扩散率 (Thermal diffusivity)** [m²/s]。

    *   **Steady-state equation (稳态方程) ($\partial T/\partial t = 0$):**
        $$
        \lambda\left(\frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2}\right) - q = 0
        $$
        或者：
        $$
        \frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2} = \frac{q}{\lambda}
        $$
        此为 **偏微分方程 (Partial Differential Equation, PDE)**。

    *   **与一维方程对比:**
        一维稳态: $\frac{d^2T}{dx^2} = \frac{q}{\lambda}$ (常微分方程 (Ordinary Differential Equation, ODE))。

---

## 第三部分：二维稳态热传导仿真案例 (2D Steady-State Heat Conduction Simulation Cases)

假设内部存在均匀热源/汇。若 $q$ 定义为热损失，则方程中 $q/\lambda$ 项应理解为 $-q_{loss}/\lambda$；若 $q$ 定义为热源，则为 $q_{source}/\lambda$。图片中方程写为 $q/\lambda$，通常 $q$ 指热源。这里按图片方程形式，假定 $q$ 为热源项值。

### Case 1: 边界为固定温度 (Fixed temperature at boundaries) - Dirichlet
*   **描述:** 上边界 ($y=L$) 温度为 $T_H$，其余三边温度为 $T_L$。内部均匀热源 $q = 1$ [J/m³s] (假设)。
*   **控制方程 (Governing equation):**
    $$
    \frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2} = \frac{q}{\lambda}
    $$
*   **边界条件 (Boundary condition):**
    *   $T(x, y=L) = T_H$
    *   $T(x, y=0) = T_L$
    *   $T(x=0, y) = T_L$
    *   $T(x=L, y) = T_L$

### Case 2: 边界也为固定温度 (Fixed temperature also at boundaries) - Dirichlet
*   **描述:** 上、下边界温度为 $T_L$，左、右边界温度为 $T_H$。内部均匀热源 $q = 1$ [J/m³s] (假设)。
*   **控制方程 (Governing equation):**
    $$
    \frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2} = \frac{q}{\lambda}
    $$
*   **边界条件 (Boundary condition):**
    *   $T(x, y=0) = T_L$
    *   $T(x, y=L) = T_L$
    *   $T(x=0, y) = T_H$
    *   $T(x=L, y) = T_H$

### Case 3: 通过对流假设热交换 (Heat exchange by convection) - Robin
*   **描述:** 四个边界均通过对流方式与环境温度为 $T_H$ 的流体进行热交换。
*   **对流换热 (Convection Heat Transfer):**
    热流密度 (Heat flux density) $q_{conv} = h(T_s - T_a)$
    *   $h$: 对流换热系数 (Heat transfer coefficient) [W/m²K]
    *   $T_s$: 表面温度 (Surface temperature)
    *   $T_a$: 环境温度 (Ambient temperature)
*   **控制方程 (Governing equation):** (内部仍可有源项 $q$)
    $$
    \frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2} = \frac{q}{\lambda}
    $$
*   **边界条件 (Boundary condition) (基于能量守恒：离开固体的导热热流 = 离开固体的对流热流):**
    设外法向为 $\mathbf{n}$，则离开固体的导热热流密度为 $-\lambda (\nabla T \cdot \mathbf{n})$。
    *   左边界 ($x=0$, $\mathbf{n}=(-1,0)$):
        $-\lambda \left(\frac{\partial T}{\partial x}\right)\Big|_{x=0} \cdot (-1) = \lambda \left(\frac{\partial T}{\partial x}\right)\Big|_{x=0} = h(T(0,y) - T_H)$
        (图片公式为: $-\lambda (\partial T/\partial x)|_{x=0} = h(T(0,y) - T_H)$。这暗示 $\partial T/\partial x$ 在此被视为沿+x方向的梯度。)
    *   右边界 ($x=L$, $\mathbf{n}=(1,0)$):
        $-\lambda \left(\frac{\partial T}{\partial x}\right)\Big|_{x=L} \cdot (1) = -\lambda \left(\frac{\partial T}{\partial x}\right)\Big|_{x=L} = h(T(L,y) - T_H)$
        (图片公式同此。)
    *   下边界 ($y=0$, $\mathbf{n}=(0,-1)$):
        $-\lambda \left(\frac{\partial T}{\partial y}\right)\Big|_{y=0} \cdot (-1) = \lambda \left(\frac{\partial T}{\partial y}\right)\Big|_{y=0} = h(T(x,0) - T_H)$
        (图片公式为: $-\lambda (\partial T/\partial y)|_{y=0} = h(T(x,0) - T_H)$。)
    *   上边界 ($y=L$, $\mathbf{n}=(0,1)$):
        $-\lambda \left(\frac{\partial T}{\partial y}\right)\Big|_{y=L} \cdot (1) = -\lambda \left(\frac{\partial T}{\partial y}\right)\Big|_{y=L} = h(T(x,L) - T_H)$
        (图片公式同此。)
    *注：为与图片保持一致，下面采用图片给出的边界条件梯度项。理解时需注意法线方向和热流方向。*
    *   左边界 (Left boundary, $x=0$): $-\lambda \left(\frac{\partial T}{\partial x}\right)\Big|_{x=0} = h(T(0,y) - T_H)$
    *   右边界 (Right boundary, $x=L$): $-\lambda \left(\frac{\partial T}{\partial x}\right)\Big|_{x=L} = h(T(L,y) - T_H)$
    *   下边界 (Bottom boundary, $y=0$): $-\lambda \left(\frac{\partial T}{\partial y}\right)\Big|_{y=0} = h(T(x,0) - T_H)$
    *   上边界 (Top boundary, $y=L$): $-\lambda \left(\frac{\partial T}{\partial y}\right)\Big|_{y=L} = h(T(x,L) - T_H)$

*   **<Poisson equation> (泊松方程):**
    一般形式: $\nabla^2\phi(\mathbf{x}) = S(\mathbf{x})$
    二维笛卡尔坐标: $\frac{\partial^2\phi}{\partial x^2} + \frac{\partial^2\phi}{\partial y^2} = S(x,y)$
    (热传导问题中 $\phi=T$, $S=q/\lambda$ 或 $-q/\lambda$ 取决于 $q$ 定义)。若 $S=0$，则为 **拉普拉斯方程 (Laplace equation)**。

---

## 第四部分：二维稳态热传导方程的离散化 (Discretization of 2D Steady-State HCE)

### <Discretization> (离散化)
1.  **定义网格 (Define grids)**
2.  **离散化方程 (Discretize the equation/equations)**
3.  **应用迭代方法 (Apply an iterative method)**
4.  **绘制流程图 (Draw a flowchart)**

### (1) 定义控制体积、网格和节点 (Define the control volume, grids, and nodes)
*   **索引 (Indices):**
    *   $I$: $x$方向的节点编号 (Node number in x-direction)
    *   $J$: $y$方向的节点编号 (Node number in y-direction)
*   **温度 (Temperature):** $T_{I,J}$ 为节点 $(I,J)$ 处的温度。
*   **控制体积尺寸 (CV dimensions):**
    *   $\Delta x_I$: 控制体积 $(I,J)$ 在 $x$ 方向的长度。
    *   $\Delta y_J$: 控制体积 $(I,J)$ 在 $y$ 方向的长度。
    *   *注：图片中 `Δx_0 = Δx_{N+1} = 0` 的表述不寻常，通常边界节点关联半个控制体积，或此为特定边界处理方式。*
*   **网格划分 (Gridding):**
    *   $N$: 每个方向上的内部节点/单元数量 (Number of internal nodes/cells in each direction)。
    *   均匀网格 (Uniform grid): $\Delta x = L/N_x$, $\Delta y = L/N_y$。
*   **索引约定 (Index convention):** 大写 $I,J$ 表示控制体积中心节点；小写 $i,j$ (或 $e,w,n,s$) 表示控制体积界面。

### (2) 推导离散方程 (Derive the discretized equations)
*   **控制方程 (Governing Equation):**
    $$
    \frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2} = \frac{q}{\lambda}
    $$
*   **控制体积积分 (Control Volume Integration):**
    对节点 $(I,J)$ 的控制体积 $CV$ (面积 $A_{CV} = \Delta x_I \Delta y_J$) 进行积分：
    $$
    \iint_{CV} \left( \frac{\partial^2T}{\partial x^2} + \frac{\partial^2T}{\partial y^2} \right) dx dy = \iint_{CV} \frac{q}{\lambda} dx dy
    $$
*   **左边项 (LHS) - x方向 (x-direction):**
    $$
    \iint_{CV} \frac{\partial^2T}{\partial x^2} dx dy = \int_{\Delta y_J} \left[ \int_{\Delta x_I} \frac{\partial^2T}{\partial x^2} dx \right] dy = \left[ \left(\frac{\partial T}{\partial x}\right)\Big|_e - \left(\frac{\partial T}{\partial x}\right)\Big|_w \right] \Delta y_J
    $$
    界面梯度近似 (Interface gradient approximations)：
    *   东界面 (East face, $e$): $\left(\frac{\partial T}{\partial x}\right)\Big|_e \approx \frac{T_{I+1,J} - T_{I,J}}{0.5(\Delta x_{I+1} + \Delta x_I)}$
    *   西界面 (West face, $w$): $\left(\frac{\partial T}{\partial x}\right)\Big|_w \approx \frac{T_{I,J} - T_{I-1,J}}{0.5(\Delta x_I + \Delta x_{I-1})}$

*   **左边项 (LHS) - y方向 (y-direction):**
    $$
    \iint_{CV} \frac{\partial^2T}{\partial y^2} dx dy = \int_{\Delta x_I} \left[ \int_{\Delta y_J} \frac{\partial^2T}{\partial y^2} dy \right] dx = \left[ \left(\frac{\partial T}{\partial y}\right)\Big|_n - \left(\frac{\partial T}{\partial y}\right)\Big|_s \right] \Delta x_I
    $$
    界面梯度近似 (Interface gradient approximations)：
    *   北界面 (North face, $n$): $\left(\frac{\partial T}{\partial y}\right)\Big|_n \approx \frac{T_{I,J+1} - T_{I,J}}{0.5(\Delta y_{J+1} + \Delta y_J)}$
    *   南界面 (South face, $s$): $\left(\frac{\partial T}{\partial y}\right)\Big|_s \approx \frac{T_{I,J} - T_{I,J-1}}{0.5(\Delta y_J + \Delta y_{J-1})}$

*   **右边项 (RHS) - 源项 (Source term):**
    假设 $q$ 和 $\lambda$ 在 $CV$ 内为常数或平均值 $q_{I,J}, \lambda_{I,J}$：
    $$
    \iint_{CV} \frac{q}{\lambda} dx dy \approx \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J
    $$

*   **组合各项 (Combining terms):**
    将上述各项代入积分后的方程，并整理（将减项的分子分母同乘-1后变加号）：
    $$
    \left[ \frac{T_{I+1,J} - T_{I,J}}{0.5(\Delta x_{I+1} + \Delta x_I)} + \frac{T_{I-1,J} - T_{I,J}}{0.5(\Delta x_I + \Delta x_{I-1})} \right] \Delta y_J + \left[ \frac{T_{I,J+1} - T_{I,J}}{0.5(\Delta y_{J+1} + \Delta y_J)} + \frac{T_{I,J-1} - T_{I,J}}{0.5(\Delta y_J + \Delta y_{J-1})} \right] \Delta x_I = \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J
    $$

*   **引入系数 (Introducing coefficients):**
    $C_e(T_{I+1,J} - T_{I,J}) + C_w(T_{I-1,J} - T_{I,J}) + C_n(T_{I,J+1} - T_{I,J}) + C_s(T_{I,J-1} - T_{I,J}) = \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J$
    其中：
    *   $C_e = \frac{\Delta y_J}{0.5(\Delta x_{I+1} + \Delta x_I)}$ (东向系数)
    *   $C_w = \frac{\Delta y_J}{0.5(\Delta x_I + \Delta x_{I-1})}$ (西向系数)
    *   $C_n = \frac{\Delta x_I}{0.5(\Delta y_{J+1} + \Delta y_J)}$ (北向系数)
    *   $C_s = \frac{\Delta x_I}{0.5(\Delta y_J + \Delta y_{J-1})}$ (南向系数)
    *(这些系数可视为 $\lambda \frac{A_{face}}{L_{nodes}}$ 中的几何部分，因为方程已除以 $\lambda$)*

*   **整理求解 $T_{I,J}$ (Arranging for $T_{I,J}$):**
    $(C_e + C_w + C_n + C_s)T_{I,J} = C_e T_{I+1,J} + C_w T_{I-1,J} + C_n T_{I,J+1} + C_s T_{I,J-1} - \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J$
    令 $C_0 = C_e + C_w + C_n + C_s$ (中心节点系数):
    $C_0 T_{I,J} = C_e T_{I+1,J} + C_w T_{I-1,J} + C_n T_{I,J+1} + C_s T_{I,J-1} - \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J$
    最终 $T_{I,J}$ 的迭代表达式：
    $$
    T_{I,J} = \frac{1}{C_0} \left[ C_e T_{I+1,J} + C_w T_{I-1,J} + C_n T_{I,J+1} + C_s T_{I,J-1} - \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J \right]
    $$

### <1D and 2D to 3D> (从一维、二维到三维的推广)

*   **一维 (1D HCE):** $C_0 = C_e + C_w$
    $$
    T_I = \frac{1}{C_0} \left[ C_e T_{I+1} + C_w T_{I-1} - \frac{q_I}{\lambda_I} \Delta x_I \right]
    $$
    $C_e = \frac{1}{0.5(\Delta x_{I+1} + \Delta x_I)}$, $C_w = \frac{1}{0.5(\Delta x_I + \Delta x_{I-1})}$

*   **二维 (2D HCE):** (如上推导) $C_0 = C_e + C_w + C_n + C_s$
    $$
    T_{I,J} = \frac{1}{C_0} \left[ C_e T_{I+1,J} + C_w T_{I-1,J} + C_n T_{I,J+1} + C_s T_{I,J-1} - \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J \right]
    $$

*   **三维 (3D HCE):** 增加前(f)/后(b)方向的通量。$C_0 = C_e + C_w + C_n + C_s + C_f + C_b$
    $$
    T_{I,J,K} = \frac{1}{C_0} \left[ C_e T_{I+1,J,K} + C_w T_{I-1,J,K} + C_n T_{I,J+1,K} + C_s T_{I,J-1,K} + C_f T_{I,J,K+1} + C_b T_{I,J,K-1} - \frac{q_{I,J,K}}{\lambda_{I,J,K}}\Delta x_I \Delta y_J \Delta z_K \right]
    $$
    三维系数 (3D Coefficients):
    *   $C_e = \frac{\Delta y_J \Delta z_K}{0.5(\Delta x_{I+1} + \Delta x_I)}$
    *   $C_w = \frac{\Delta y_J \Delta z_K}{0.5(\Delta x_I + \Delta x_{I-1})}$
    *   $C_n = \frac{\Delta x_I \Delta z_K}{0.5(\Delta y_{J+1} + \Delta y_J)}$
    *   $C_s = \frac{\Delta x_I \Delta z_K}{0.5(\Delta y_J + \Delta y_{J-1})}$
    *   $C_f = \frac{\Delta x_I \Delta y_J}{0.5(\Delta z_{K+1} + \Delta z_K)}$ (前向, Front)
    *   $C_b = \frac{\Delta x_I \Delta y_J}{0.5(\Delta z_K + \Delta z_{K-1})}$ (后向, Back)

*   **说明:**
    *   $I,J,K$ 分别为 $x,y,z$ 方向的节点索引。下标 $e,w,n,s,f,b$ 表示各方向的界面。
    *   处理低维问题时，只需移除不出现的方向的相关系数即可。
    *   控制体积微元 $dV$ (离散为 $\Delta V$) 随维度变化：
        *   1D: $\Delta V = \Delta x_I$
        *   2D: $\Delta V = \Delta x_I \Delta y_J$
        *   3D: $\Delta V = \Delta x_I \Delta y_J \Delta z_K$

---

## 第五部分：迭代求解方法 (Iterative Solution Methods)

### (3) 应用迭代方法 (Apply the iterative method)
离散方程形如 $T_{node} = f(T_{neighbors}, Source)$，即 $x = g(x)$，适合迭代求解。
用 $T^p$ 表示上一次迭代的预测值 (Predicted/Previous value)。

*   **<Jacobi method> (雅可比法):**
    计算新值 $T_{I,J}$ 时，右侧所有邻居节点均使用上一步迭代 $k$ 的值 $T^p (=T^k)$。
    $$
    T_{I,J}^{k+1} = \frac{1}{C_0} \left[ C_e T^p_{I+1,J} + C_w T^p_{I-1,J} + C_n T^p_{I,J+1} + C_s T^p_{I,J-1} - \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J \right]
    $$

*   **<Gauss-Seidel method> (高斯-赛德尔法):**
    若按特定顺序 (如 $I$ 从小到大，$J$ 从小到大) 更新节点，则 $T_{I-1,J}$ 和 $T_{I,J-1}$ 在计算 $T_{I,J}$ 时已经更新为当前迭代步 $k+1$ 的值。
    $$
    T_{I,J}^{k+1} = \frac{1}{C_0} \left[ C_e T^{k}_{I+1,J} + C_w T^{k+1}_{I-1,J} + C_n T^{k}_{I,J+1} + C_s T^{k+1}_{I,J-1} - \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J \right]
    $$
    (使用同一迭代步内已计算出的最新值)

*   **<Successive Over-Relaxation (SOR) method> (逐次超松弛法):**
    引入松弛因子 (Relaxation Factor) $\omega$ (图片中用 $\beta$) 来加速或稳定收敛。
    1.  首先用高斯-赛德尔法计算一个临时值 $T^*_{I,J}$:
        $$
        T^*_{I,J} = \frac{1}{C_0} \left[ C_e T^{k}_{I+1,J} + C_w T^{k+1}_{I-1,J} + C_n T^{k}_{I,J+1} + C_s T^{k+1}_{I,J-1} - \frac{q_{I,J}}{\lambda_{I,J}} \Delta x_I \Delta y_J \right]
        $$
    2.  然后通过松弛更新 $T_{I,J}^{k+1}$:
        $$
        T_{I,J}^{k+1} = T_{I,J}^k + \omega (T^*_{I,J} - T_{I,J}^k)
        $$
        或者写为 (等价于图片中的形式，若 $T'_{I,J} = T^*_{I,J}$ 且 $\omega = \beta$):
        $$
        T_{I,J}^{k+1} = (1-\omega)T_{I,J}^k + \omega T^*_{I,J}
        $$
    *   $\omega = 1$: 退化为高斯-赛德尔法。
    *   $0 < \omega < 1$: **欠松弛 (Under-relaxation)**, 用于改善某些非线性或耦合问题的收敛稳定性。
    *   $1 < \omega < 2$: **超松弛 (Over-relaxation)**, 通常用于加速线性问题的收敛。
    *   *图片中提及 "β is called relaxation coefficient taken values less than 1"，这通常指欠松弛。但方法名称为SOR，一般指超松弛。实际应用中 $\omega$ 的选择对收敛性至关重要。*

# 三、二维稳态热传导方程离散化笔记

## 第一部分：问题回顾与FVM离散 (2D Steady Heat Conduction)

### 1. 控制方程 (Governing Equation)
二维稳态热传导方程 (2D steady-state heat conduction equation) 如下：
$$
\frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2} = \frac{q(x,y)}{\lambda}
$$
其中：
*   $T$ 是温度 (temperature)
*   $x, y$ 是空间坐标 (coordinates)
*   $\lambda$ 是热导率 (thermal conductivity)
*   $q(x,y)$ 是单位体积的热源/热沉项 (heat source/sink term per unit volume)。
    *   如果 $q > 0$，表示吸热（热沉, heat sink）。
    *   如果 $q < 0$，则表示产热（热源, heat source）。
    *   题目中 "$q(x,y)/\lambda$" 整体作为热沉项。

### 2. 离散化目标 (Discretization Objective)
求解离散网格点 $(i,j)$ 上的温度 $T_{i,j}$。$i$ 和 $j$ 分别是 $x$ 和 $y$ 方向的网格编号。

### 3. 网格系统 (Grid System)
*   控制体积 (Control Volume, CV) 围绕节点 $(i,j)$。
*   $\Delta x_i$ 是节点 $i$ 处控制体积在 $x$ 方向的宽度。
*   $\Delta y_j$ 是节点 $j$ 处控制体积在 $y$ 方向的高度。
*   控制体积的东(e)、西(w)、北(n)、南(s)界面分别位于相邻节点之间的中点。
    *   东界面 $e$ 位于节点 $(i,j)$ 和 $(i+1,j)$ 的中间。
    *   西界面 $w$ 位于节点 $(i,j)$ 和 $(i-1,j)$ 的中间。

### 4. 有限体积法 (Finite Volume Method, FVM) - 积分 (Integration)
对控制方程在每个控制体积上进行积分：
$$
\int_{CV} \left( \frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2} \right) dxdy = \int_{CV} \frac{q}{\lambda} dxdy
$$

*   **左侧 (扩散项, Diffusion Term)**: 利用高斯散度定理 (Gauss's divergence theorem)，将二阶偏导数的体积分转化为一阶偏导数（热通量, heat flux）在控制体表面的面积分：
    $$
    \int_{CV} \left( \frac{\partial^2 T}{\partial x^2} + \frac{\partial^2 T}{\partial y^2} \right) dxdy = \int \left( \left. \frac{\partial T}{\partial x} \right|_e - \left. \frac{\partial T}{\partial x} \right|_w \right) dy + \int \left( \left. \frac{\partial T}{\partial y} \right|_n - \left. \frac{\partial T}{\partial y} \right|_s \right) dx
    $$
    近似为：
    $$
    \left( \left. \frac{\partial T}{\partial x} \right|_e \right) \Delta y_j - \left( \left. \frac{\partial T}{\partial x} \right|_w \right) \Delta y_j + \left( \left. \frac{\partial T}{\partial y} \right|_n \right) \Delta x_i - \left( \left. \frac{\partial T}{\partial y} \right|_s \right) \Delta x_i
    $$

*   **右侧 (源项, Source Term)**: 源项的体积分近似为控制体积中心处的值乘以体积：
    $$
    \int_{CV} \frac{q}{\lambda} dxdy \approx \left( \frac{q_{i,j}}{\lambda} \right) \Delta x_i \Delta y_j
    $$

### 5. 界面通量近似 (Interface Flux Approximation)
控制体界面上的温度梯度 (temperature gradient) 使用中心差分格式 (central difference scheme) 近似：
*   东界面 $e$:
    $$ \left. \frac{\partial T}{\partial x} \right|_e \approx \frac{T_{i+1,j} - T_{i,j}}{0.5(\Delta x_{i+1} + \Delta x_i)} $$
*   西界面 $w$:
    $$ \left. \frac{\partial T}{\partial x} \right|_w \approx \frac{T_{i,j} - T_{i-1,j}}{0.5(\Delta x_i + \Delta x_{i-1})} $$
*   北界面 $n$:
    $$ \left. \frac{\partial T}{\partial y} \right|_n \approx \frac{T_{i,j+1} - T_{i,j}}{0.5(\Delta y_{j+1} + \Delta y_j)} $$
*   南界面 $s$:
    $$ \left. \frac{\partial T}{\partial y} \right|_s \approx \frac{T_{i,j} - T_{i,j-1}}{0.5(\Delta y_j + \Delta y_{j-1})} $$

### 6. 最终离散方程 (Final Discretized Equation)
将近似代入积分后的方程，整理后得到 $T_{i,j}$ 的代数方程。
一种常见形式是：
$$
C_e T_{i+1,j} + C_w T_{i-1,j} + C_n T_{i,j+1} + C_s T_{i,j-1} - (C_e+C_w+C_n+C_s)T_{i,j} = \left(\frac{q_{i,j}}{\lambda}\right)\Delta x_i \Delta y_j
$$
其中系数 (coefficients) 定义为：
*   $C_e = \frac{\Delta y_j}{0.5(\Delta x_{i+1} + \Delta x_i)}$
*   $C_w = \frac{\Delta y_j}{0.5(\Delta x_i + \Delta x_{i-1})}$
*   $C_n = \frac{\Delta x_i}{0.5(\Delta y_{j+1} + \Delta y_j)}$
*   $C_s = \frac{\Delta x_i}{0.5(\Delta y_j + \Delta y_{j-1})}$
这些 $C$ 系数代表节点 $(i,j)$ 与其相邻节点之间的“热导” (thermal conductance)。

---

## 第二部分：离散方程的通用形式与系数 (General Form and Coefficients)

### 1. 通用离散方程 (General Discretized Equation)
标准的代数方程形式为：
$$
A_P T_P = A_E T_E + A_W T_W + A_N T_N + A_S T_S + S_u
$$
对应于上一节的推导，令 $P=(i,j), E=(i+1,j), W=(i-1,j), N=(i,j+1), S=(i,j-1)$：
$$
(C_e + C_w + C_n + C_s) T_{i,j} = C_e T_{i+1,j} + C_w T_{i-1,j} + C_n T_{i,j+1} + C_s T_{i,j-1} - \left(\frac{q_{i,j}}{\lambda}\right)\Delta x_i \Delta y_j
$$
注意：这里假设 $q$ 为热沉 (heat sink)，所以源项 $S_u = - (q_{i,j}/\lambda)\Delta x_i \Delta y_j$。如果 $q$ 为热源 (heat source)，则 $S_u = (q_{i,j}/\lambda)\Delta x_i \Delta y_j$ (若 $q$ 本身带符号，则为 $+ (q_{i,j}/\lambda)\Delta x_i \Delta y_j$)。
中心节点系数 $A_P = C_o = C_e + C_w + C_n + C_s$。

页面上的形式整理为求解 $T_{i,j}$:
$$
T_{i,j} = \frac{1}{C_o} \left[ C_e T_{i+1,j} + C_w T_{i-1,j} + C_n T_{i,j+1} + C_s T_{i,j-1} - \left(\frac{q}{\lambda}\right)\Delta x_i \Delta y_j \right]
$$
(源项符号取决于 $q$ 的定义，若 $q/ \lambda$ 是热沉项，移到右边应为负号，除非 $q$ 本身是负值代表吸热。按第一页推导， $q/\lambda$ 在等号右边是正的，则移项后 $S_p$ 应为 $+(q/\lambda)\Delta x_i \Delta y_j$ (如果$q$是热源)。)

### 2. 系数定义 (Coefficients Definition)
*   $C_e = \frac{\Delta y_j}{0.5(\Delta x_i + \Delta x_{i+1})}$
*   $C_w = \frac{\Delta y_j}{0.5(\Delta x_i + \Delta x_{i-1})}$
*   $C_n = \frac{\Delta x_i}{0.5(\Delta y_j + \Delta y_{j+1})}$
*   $C_s = \frac{\Delta x_i}{0.5(\Delta y_j + \Delta y_{j-1})}$
*   $C_o = C_e + C_w + C_n + C_s$

### 3. 均匀网格示例 (Uniform Grid Example)
如果网格是均匀的 (uniform grid)，即 $\Delta x_i = \Delta x$ (对所有 $i$) 且 $\Delta y_j = \Delta y$ (对所有 $j$)。
*   对于内部节点 (internal node)：
    *   $C_e = \frac{\Delta y}{\Delta x}$
    *   $C_w = \frac{\Delta y}{\Delta x}$
    *   $C_n = \frac{\Delta x}{\Delta y}$
    *   $C_s = \frac{\Delta x}{\Delta y}$
*   **特殊情况：如果 $\Delta x = \Delta y$ (方形网格, square grid)**:
    则对于内部节点，$C_e = C_w = C_n = C_s = 1$。

### 4. 边界节点示例 (Boundary Node Example)
计算第一个节点（$i=1$）的西侧系数 $C_w$：
*   假设 $I=0$ 是左边界 (left boundary)，并且 $\Delta x_0 = 0$。
*   $C_w(I=1) = \frac{\Delta y_j}{0.5(\Delta x_1 + \Delta x_0)} = \frac{\Delta y_j}{0.5\Delta x_1}$
*   如果此时 $\Delta y_j = \Delta x_1$ (即第一个单元是方形的)，那么 $C_w(I=1) = \frac{\Delta x_1}{0.5\Delta x_1} = 2$。

### 5. 结论性示意图
一个位于角落的方形单元，如果其相邻“虚拟”节点的控制体积宽度/高度为0 (e.g., $\Delta x_{i-1}=0, \Delta x_{i+1}=0, \Delta y_{j-1}=0, \Delta y_{j+1}=0$)，且 $\Delta x = \Delta y$：
*   $C_e = \frac{\Delta y}{0.5\Delta x} = 2$
*   $C_w = \frac{\Delta y}{0.5\Delta x} = 2$
*   $C_n = \frac{\Delta x}{0.5\Delta y} = 2$
*   $C_s = \frac{\Delta x}{0.5\Delta y} = 2$
这通常用于处理某些类型的边界条件 (boundary conditions)，如绝热边界 (adiabatic boundary) 或对称边界 (symmetry boundary)。

---
---

# 四、一维非稳态热传导方程的数值模拟 (Numerical simulation of one-dimensional unsteady heat conduction equation - 1D UHCE)

## 第一部分：问题描述与控制方程

### 1. <Schematics> (示意图)
*   模拟对象与#02（可能是稳态问题）相同，但包含温度分布的时间变化。即 $T = T(x,t)$。
*   **示意图描述**:
    *   一维杆件，长度为 $L$。
    *   左端 ($x=0$): 恒定低温 $T_L$ [K] (边界条件, Boundary Condition, B.C.)。
    *   右端 ($x=L$): 恒定高温 $T_H$ [K]，且 $T_H > T_L$ (边界条件, B.C.)。
    *   不同时刻的温度分布曲线：
        *   $t=0$: 初始时刻 (initial time)，整个杆件温度为 $T_L$ (初始条件, Initial Condition, I.C.)。
        *   $t, \tau$ (不同时间点): 温度曲线向最终稳态分布演变。
        *   虚线: 稳态 (steady-state) 温度分布 (线性)。此时 $\frac{\partial^2 T}{\partial x^2} = 0$。

### 2. <Purpose> (目的)
*   理解非稳态模拟 (unsteady simulations) 的本质（显式 (explicit) 和隐式方法 (implicit methods)）。
*   对一维非稳态热传导方程 (1D UHCE) 的控制方程进行离散化 (discretize)。
*   对温度分布进行数值模拟 (numerically simulate)。

### 3. <Governing equation> (控制方程)
*   **材料属性 (Material Properties)**:
    *   $\rho C_p$ [J/m³K]: 体积热容 (Volumetric heat capacity)。 $\rho$ 是密度 (density)，$C_p$ 是比热容 (Specific heat capacity)。
    *   $\lambda$ [J/mKs] (或 [W/mK]): 热导率 (Thermal conductivity)。
*   **定义 (Definitions)**:
    *   $t$: 时间 (time) [s]
    *   $x$: 空间坐标 (coordinate) [m]
    *   $T(x,t)$: 温度 (temperature) [K]
    *   $L$: 金属杆的长度 (length) [m]
    *   $T_L$: $x=0$ 处的温度 [K]
    *   $T_H$: $x=L$ 处的温度 [K] (假设 $T_H > T_L$)
*   **控制方程 (Governing equation) → 1D UHCE**:
    $$
    \rho C_p \frac{\partial T}{\partial t} = \lambda \frac{\partial^2 T}{\partial x^2}
    $$
    或者:
    $$
    \frac{\partial T}{\partial t} = \alpha \frac{\partial^2 T}{\partial x^2}
    $$
    其中 $\alpha = \frac{\lambda}{\rho C_p}$ 是热扩散率 (Thermal diffusivity) [m²/s]。
*   **玻尔兹曼变换 (Boltzmann Transform) - (手写注释)**:
    *   相似变量 (similarity variable): $\eta = \frac{x}{2\sqrt{\alpha t}}$
    *   $\alpha = \frac{\lambda}{\rho C_p}$ [m²/s]
    *   $T(x,t) \rightarrow T(\eta)$
    *   这是一种将偏微分方程 (PDE) 转化为常微分方程 (ODE) 的解析方法。

### 4. 边界条件 (Boundary Conditions, BC) 和初始条件 (Initial Condition, IC)
*   $T(x=0, t) = T_L$ (狄利克雷边界条件, Dirichlet boundary condition)
*   $T(x=L, t) = T_H$ (狄利克雷边界条件, Dirichlet boundary condition)
*   $T(x, t=0) = T_L$ (初始条件, Initial condition)

---

## 第二部分：离散化 (Discretization)

### 1. 推导离散方程的过程
    (1) 定义数值网格 (Define numerical grids)
    (2) 离散化方程 (Discretize the equation)
    (3) 应用迭代方法 (Apply an iterative method) (针对隐式方法)
    (4) 绘制流程图 (Draw a flowchart)

### 2. (1) 定义数值网格和节点 (Define numerical grids and nodes)
*   一维空间 $0$ 到 $L$，离散节点 $T_{i-1}, T_i, T_{i+1}$。
*   围绕节点 $T_i$ 定义控制体积 (Control Volume, CV)，西边界 $w$，东边界 $e$。
*   $w$ 位于 $i-1$ 和 $i$ 中点，$e$ 位于 $i$ 和 $i+1$ 中点。
*   **定义**:
    *   $I$: 节点编号 (Node number)
    *   $T_i$: 节点 $I$ 处的温度 (Temp. at node I)
    *   $\Delta x_i$: 控制体积 $I$ 的宽度 (Width of C.V. I)
    *   $N$: 内部计算节点总数 (Total number of internal nodes)。
        *   节点 $0$ 位于 $x=0$，节点 $N+1$ 位于 $x=L$。总共 $N+2$ 个节点。
        *   $T_0 = T_L, T_{N+1} = T_H$ (边界条件给定)。
        *   $\Delta x_0 = \Delta x_{N+1} = 0$ (边界节点处理方式)。
    *   $\Delta t$: 时间步长 (Time step) [s]。

### 3. (2) 从控制方程推导离散方程 (Derive discretized equations)
控制方程:
$$
\rho C_p \frac{\partial T}{\partial t} = \lambda \frac{\partial^2 T}{\partial x^2}
$$
应用FVM，对1D UHCE在一个CV上进行积分 ($dV = A dx$, $A$为横截面积，可约去)：
$$
\int_{CV} \rho C_p \frac{\partial T}{\partial t} dx = \int_{CV} \lambda \frac{\partial^2 T}{\partial x^2} dx
$$
区别于稳态方程，存在储能项 (Storage term): $\rho C_p \frac{\partial T}{\partial t}$。

*   **右侧项 (RHS) 离散化 (Discretization of Right-Hand Side)**: (同1D稳态)
    $$
    \int_{CV} \lambda \frac{\partial^2 T}{\partial x^2} dx = \lambda \left( \left. \frac{\partial T}{\partial x} \right|_e - \left. \frac{\partial T}{\partial x} \right|_w \right)
    $$
    界面梯度近似 (Gradient approximation at interfaces)：
    $$ \left. \frac{dT}{dx} \right|_e = \frac{T_{i+1} - T_i}{\delta x_e} = \frac{T_{i+1} - T_i}{0.5(\Delta x_{i+1} + \Delta x_i)} $$
    $$ \left. \frac{dT}{dx} \right|_w = \frac{T_i - T_{i-1}}{\delta x_w} = \frac{T_i - T_{i-1}}{0.5(\Delta x_i + \Delta x_{i-1})} $$
    (这里的 $\Delta x_k$ 是节点 $k$ 对应控制体积的宽度，$\delta x_e, \delta x_w$ 是节点间距)

*   **左侧项 (LHS) 离散化 (Discretization of Left-Hand Side - Time Term)**:
    定义 $t = n\Delta t$ 时刻的离散温度为 $T_i^n = T(x_i, n\Delta t)$。
    时间导数向前差分 (Forward difference for time derivative)：
    $$
    \int_{CV} \rho C_p \frac{\partial T}{\partial t} dx \approx \rho C_p \left( \frac{T_i^{n+1} - T_i^n}{\Delta t} \right) \Delta x_i
    $$

*   **组合离散方程 (Combined Discretized Equation)**:
    假设右侧空间导数项中的温度取自 $n$ 时刻 (显式格式, Explicit scheme):
    $$
    \rho C_p \Delta x_i \frac{T_i^{n+1} - T_i^n}{\Delta t} = \lambda \frac{T_{i+1}^n - T_i^n}{0.5(\Delta x_{i+1} + \Delta x_i)} - \lambda \frac{T_i^n - T_{i-1}^n}{0.5(\Delta x_i + \Delta x_{i-1})}
    $$
    整理为：
    $$
    C_0 (T_i^{n+1} - T_i^n) = C_e (T_{i+1}^n - T_i^n) + C_w (T_{i-1}^n - T_i^n)
    $$
    (教材中的形式，注意西侧项 $T_{i-1}^n - T_i^n$ 意味着从左向右的通量贡献，与 $T_i^n - T_{i-1}^n$ 符号相反，但最终整理系数时效果一致。)
    更标准的写法，展开后将所有 $T^n$ 项合并：
    $$
    C_0 T_i^{n+1} = C_e T_{i+1}^n + C_w T_{i-1}^n + (C_0 - C_e - C_w) T_i^n
    $$

*   **系数定义 (Coefficients Definition)**:
    *   $C_0 = \frac{\rho C_p \Delta x_i}{\Delta t}$
    *   $C_e = \frac{\lambda}{0.5(\Delta x_{i+1} + \Delta x_i)} = \frac{\lambda}{\delta x_e}$
    *   $C_w = \frac{\lambda}{0.5(\Delta x_i + \Delta x_{i-1})} = \frac{\lambda}{\delta x_w}$

---

## 第三部分：显式与隐式方法 (Explicit and Implicit Methods)

对于RHS中 $T_{I\pm1}$ 和 $T_I$ 的取值时刻，有两种选择：

### 1. <Explicit method> (显式方法, 陽解法)
取时间步 $n$ (上一时间步, previous time step) 的温度值：
$$
C_0 (T_I^{n+1} - T_I^n) = C_e (T_{I+1}^n - T_I^n) + C_w (T_{I-1}^n - T_I^n)
$$
求解 $T_I^{n+1}$:
$$
T_I^{n+1} = \frac{1}{C_0} \left[ C_e T_{I+1}^n + C_w T_{I-1}^n + (C_0 - C_e - C_w) T_I^n \right]
$$
*   $T_I^{n+1}$ 由 $n$ 时刻的已知温度显式确定。
*   计算模板：$T_I^{n+1}$ 依赖于 $T_{I-1}^n, T_I^n, T_{I+1}^n$。

### 2. <Implicit method> (隐式方法, 陰解法)
取时间步 $n+1$ (当前待求解时间步, current time step) 的温度值：
$$
C_0 (T_I^{n+1} - T_I^n) = C_e (T_{I+1}^{n+1} - T_I^{n+1}) + C_w (T_{I-1}^{n+1} - T_I^{n+1})
$$
整理后：
$$
(C_0 + C_e + C_w) T_I^{n+1} = C_e T_{I+1}^{n+1} + C_w T_{I-1}^{n+1} + C_0 T_I^n
$$
令 $C_d = C_0 + C_e + C_w$:
$$
T_I^{n+1} = \frac{1}{C_d} \left[ C_e T_{I+1}^{n+1} + C_w T_{I-1}^{n+1} + C_0 T_I^n \right]
$$
*   $T_I^{n+1}$ 的求解依赖于同一时刻 $n+1$ 的邻近节点温度 $T_{I\pm1}^{n+1}$。
*   形成一个联立方程组 (system of simultaneous equations)，需要求解。
*   计算模板：$T_I^{n+1}$ 依赖于 $T_I^n$ 以及 $T_{I-1}^{n+1}, T_I^{n+1}, T_{I+1}^{n+1}$。

### 3. (3) 应用迭代方法 (Apply an iterative method) - 针对隐式方法
使用上一次迭代的预测值 $T^P$ (Prediction value) 来计算当前迭代的 $T_I^{n+1}$：
$$
T_I^{n+1, (k+1)} = \frac{1}{C_d} \left[ C_e T_{I+1}^{n+1, (k)} + C_w T_{I-1}^{n+1, (k)} + C_0 T_I^n \right]
$$
其中 $(k)$ 表示迭代次数。迭代直至 $T^{n+1}$ 收敛 (converge)。

---

## 第四部分：收敛准则 (Convergence Criteria) / 稳定性分析 (Stability Analysis)

### 1. <Explicit method> (显式方法)
从 $T_I^{n+1} = \frac{1}{C_0} \left[ C_e T_{I+1}^n + C_w T_{I-1}^n + (C_0 - C_e - C_w) T_I^n \right]$，
可近似认为 $T_I^{n+1} \propto \left( \frac{C_0 - C_e - C_w}{C_0} \right) T_I^n = \left( 1 - \frac{C_e + C_w}{C_0} \right) T_I^n$。
对于均匀网格 (uniform grid) $\Delta x_i = \Delta x$:
*   $C_e = C_w = \frac{\lambda}{\Delta x}$
*   $C_0 = \frac{\rho C_p \Delta x}{\Delta t}$
则 $\frac{C_e + C_w}{C_0} = \frac{2\lambda/\Delta x}{\rho C_p \Delta x / \Delta t} = 2 \frac{\lambda}{\rho C_p} \frac{\Delta t}{\Delta x^2} = 2 \alpha \frac{\Delta t}{\Delta x^2}$。
令扩散数 (Diffusion number) $r = \alpha \frac{\Delta t}{\Delta x^2}$。
则 $T_I^{n+1} \propto (1 - 2r) T_I^n$。
为保证数值稳定 (numerical stability)（误差不放大），要求放大因子 (amplification factor) 的绝对值 $|1-2r| \le 1$。
*   $-1 \le 1-2r \Rightarrow 2r \le 2 \Rightarrow r \le 1$
*   $1-2r \le 1 \Rightarrow -2r \le 0 \Rightarrow r \ge 0$
所以 $0 \le r \le 1$。
为了避免数值震荡 (numerical oscillation)，通常要求 $1-2r \ge 0$，即 $2r \le 1 \Rightarrow r \le \frac{1}{2}$。
综合得到稳定性条件 (stability condition)：
$$
0 \le r \le \frac{1}{2} \quad \text{or} \quad \alpha \frac{\Delta t}{\Delta x^2} \le \frac{1}{2}
$$
因此，时间步长 (time step) $\Delta t$ 需满足：
$$
\Delta t \le \frac{\Delta x^2}{2\alpha}
$$
显式方法是 **条件稳定 (Conditionally stable)**。

### 2. <Implicit method> (隐式方法)
从 $T_I^{n+1} = \frac{1}{C_d} \left[ C_e T_{I+1}^{n+1} + C_w T_{I-1}^{n+1} + C_0 T_I^n \right]$，
可近似认为 $T_I^{n+1} \propto \left( \frac{C_0}{C_d} \right) T_I^n = \left( \frac{C_0}{C_0 + C_e + C_w} \right) T_I^n = \left( \frac{1}{1 + \frac{C_e+C_w}{C_0}} \right) T_I^n$。
对于均匀网格和扩散数 $r$:
$T_I^{n+1} \propto \left( \frac{1}{1 + 2r} \right) T_I^n$。
放大因子为 $\frac{1}{1+2r}$。由于 $r = \alpha \frac{\Delta t}{\Delta x^2} \ge 0$，
所以 $0 < \frac{1}{1+2r} \le 1$。
这意味着其绝对值总是小于等于1。
隐式方法是 **无条件稳定 (Unconditionally stable)**。

### 3. 关于稳定性和准确性的说明
*   **数值稳定 (Numerically stable)** 和 **准确 (Accurate)** 是不同的概念。
*   隐式方法数值稳定，意味着计算不会发散 (diverge)，但如果时间步长 $\Delta t$ 过大，虽然稳定，解的准确性 (accuracy) 会很差，因为时间截断误差 (truncation error) 会很大。
*   选择合适的 $\Delta t$ 需要在稳定性、准确性和计算效率之间权衡。

</div>